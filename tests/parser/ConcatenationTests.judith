object ParserGenerator := Objects.Parsing.ParserGenerator

object ConcatenationTests := Object |[

    object parser :=
        ParserGenerator.concatenation(
            List.copy
                .push(ParserGenerator.literal("foo"))
                .push(ParserGenerator.literal(" "))
                .push(ParserGenerator.literal("bar"))
        )

    method parseSucceeds [
        object parseResult := parser.parse("foo bar")
        Assert.that(parseResult : List)
        Assert.that("foo" = parseResult.get(0))
        Assert.that(" "   = parseResult.get(1))
        Assert.that("bar" = parseResult.get(2))
    ]
    
    method parseFails [
        Assert.that(null = parser.parse("foo "))
    ]

]|

ConcatenationTests
    .parseSucceeds
    .parseFails
