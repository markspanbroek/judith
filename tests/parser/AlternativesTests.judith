object ParserGenerator := Objects.Parsing.ParserGenerator

object AlternativesTest := Object |[
    
    object parser := 
        ParserGenerator.alternation(
          List.copy
            .push(ParserGenerator.literal("foo"))
            .push(ParserGenerator.literal("bar"))
        )
    
    method parsingSucceedsWithLeftOperand [
        object parseResult := parser.parse("foo")
        Assert.that(parseResult : List)
        Assert.that(parseResult.length = 1)
        Assert.that(parseResult.get(0) = "foo")
    ]
    
    method parsingSucceedsWithRightOperand [
        object parseResult := parser.parse("bar")
        Assert.that(parseResult : List)
        Assert.that(parseResult.length = 1)
        Assert.that(parseResult.get(0) = "bar")
    ]
    
    method parsingFails [
        Assert.that(parser.parse("baz") = null)
    ]

]|

AlternativesTest
    .parsingSucceedsWithLeftOperand
    .parsingSucceedsWithRightOperand
    .parsingFails

